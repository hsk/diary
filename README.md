# h_sakuraiの日記

ひっそりと日記を書きたいので、ここに書く。

# 2015/10/03

- [ ] extensive rows 2 だけのこってるのもアレなので移植しよう。
- [ ] first class polymorphism
- [ ] gradual typing

土曜日だけど、今日も移植する。extensive rows2のmergeの所で引っかかって止まってたので、そこをクリアにしよう。

## 唐突に、操作的意味論がさらさら書けないの良くないと思う。

という事で書いてみる。

	e ::= x | λx.e | e1 e2

っていうBNFが書ける。ここでxは変数で、eは式である。e1 e2 ... enも式である。
論文にはよくこういう記述が現れる。JavaScriptのサブセットであるMiniJavaScriptは以下のように定義出来る。

	e ::= x | function(x) { return e; } | e1(e2)

これは表示的意味論では違うが、操作的意味論は同じ事が行われる。
JavaScriptで操作的意味論を展開してみると、


	(function(x){return e1; })(e2) -> [e2/x]e1
	e1 -> e1' ならば e1(e2) -> e1'(e2)
	e2 -> e2' ならば e1(e2) -> e1(e2')
	e -> e' ならば function(x){ return e; } -> function(x) { return e'; }

ここで[e2/x]e1はe1内のxをe2に置換するという意味である。

AならばBを

	A
	----
	B

と書くとすると、以下のように書く事が出来る。

	ーーーーーーーーーーーーーーーーーー
	function(x){return e1; }(e2)
	-> [x/e2]e1

	e1 -> e1'
	ーーーーーーーーーーー
	e1(e2) -> e1'(e2)

	e2 -> e2'
	ーーーーーーーーーーー
	e1(e2) -> e1(e2')

	e -> e'
	ーーーーーーーーーーーーーーーーーー
	function(x){ return e; } ->
	function(x){ return e'; }

λ計算にtrue,falseと三項演算子を追加する。

	e ::= ... | true | false | e1 ? e2 : e3

	e1 -> true
	ーーーーーーーーーーーー
	e1 ? e2 : e3 -> e2

	e1 -> false
	ーーーーーーーーーーーー
	e1 ? e2 : e3 -> e3

などと思って書いてみたのだけど、書く力の前に読む力がない事に気がついたりする。
TAPLを何度か見てるけど、論文読むと辛過ぎる。
CoPLも目を通したはずだけど、見ると辛い。分からない。
ということで、CoPLの図だけ見ながら書いてある式を理解してみることにした。
ゲーム感覚で、毎日見ていれば良いんじゃないか。って訳である。
ということで、1回目は、２０分くらいずつで我慢の限界が来るのだけど、それを数回。難しい所は飛ばして全体に目を通してみた。
これ毎日やるとかなり基本が身に付く気がする。操作的意味論や型理論の式に慣れてしまえば、英語の論文も式だけ見れば大体分かるはずであるし、読む時間も短く済むはず。という事でしばらく毎日呼んでみようと思う。
CoPLに眼を通すのが余裕になったらTAPLに移行すれば、より高度な型理論が頭に入るはず。

# 2015/10/02

## とりあえず目標

- [ ] first class polymorphism
- [ ] gradual typing

この２つを進める。
refined typingももうちょっと把握するとよいのかな。
移植すると結構満足感高いのだけど、深い理解が出来ているのかというと、それは別な話なので理解しやすくまとめたいと思う。
様々な、型システムの理解をより簡単にしたいけど、本当に難しいなと感じる。

ずっと目指しているのは、誰にでも簡単に出来るコンパイラ作ることなのだけど、同時に最新機能は相当良いもんを積みたい。

- [ ] extensive rows 2 だけのこってるのもアレなので移植しよう。

gradual typingは型ないJavaScriptと融合するのに向いてるのかもしれないけど、目指す言語に近い訳でもない。
first class polymorphismは使いたいのかもしれないので深く読むほうがよい。

なんかやる気ないので、extensive rows 2をちょっと触って終わった。mergeが面倒くさい。

## 享保の改革の時代

どうも、この先が見えないので色々ずっと考えている。

暴れん坊将軍の時代に、人口増加は止まって停滞期に入った。
それまでは、江戸時代が始まって人口増加してたわけだけど、限界が来た訳だ。
平成の時代も、今まさに人口の増加が止まったばかりだ。
明治維新前というよりも、今はまだ享保の改革の時代のように思える。維新を起こすには色々と課題が多過ぎる。
ここで、発展を目指せば、パイを争う事になるので、気持ちいいもんじゃない。経済的な発展は諦めて楽しくやる事が重要そうだ。

ようやく先が分かった

# 2015/10/01

## first class polymorphism をScalaに移植する

処理内容は、パースして型推論して、さらにもう１段階推論する３段構成になってます。
algorithm wの改造らしいのですが、変更も多いので一から作る事にしました。

mlをscalaに変換してパッケージ宣言を書いて、飼い業を書き換えする等した後、
構文木をコンパイル後、パーサも移植しつつ、テストも移植しつつ、型推論も移植しつつとゴリゴリ進めて行って、
パーサのテストは通り、とりあえず、コンパイルは通りました。って一気に作業出来ました。
型推論のテストを通せば終わりのはずだけど、良くわからない。

https://github.com/hsk/type-systems-scala/tree/master/first_class_polymorphism

## gradual typingをScalaに移植する。

first class polymorphismの移植に飽きた。ずっとハマってると辛い。
ということで、他のgradual typingも移植してみる。
gradual typingは、簡単に言うとActionScript3みたいに、動的な型システムに静的な型システムを持ち込む。
こちらは、algorithm wと差分が少ないようなので、差分から移植してみている。
とりあえず、コンパイルは通ったけど、テストは通らない。でも、大体動いた。

1日に２つのプロジェクトの90%くらいの移植ができたけど、ここからが長いんだよなぁ。

https://github.com/hsk/type-systems-scala/tree/master/gradual_typing

## Tronについて思う事

UNIXベースを歌うのがいいと思う。


----

[201510.md](201510.md)

[201509.md](201509.md)

[201508.md](201508.md)
